language: go
install:
- go get code.google.com/p/go.tools/cmd/cover
- go get code.google.com/p/go.tools/cmd/vet
- go get github.com/mattn/goveralls
- go get -v ./...
env:
  global:
  - secure: XbgkCwQcPJzpkaVR9HJPyKezpEDrZQEHwhYueiWgsC7YKJIqROfHQ/EPZNQpXCW/v24Sp4RQeQf4RMcnnj5Dy7XBzbkBmMIjZs/Tvp8wTwFk0BqrD2oFm7Uc//iAIIgrUnOgJl/d+GcmZHyVOhHiAuNwJTIP4Cnmjk8DKL7DdU8=
matrix:
  include:
  - go: 1.2
    env: OPTIONS="-cpu 2" COVERAGE="true"
  - go: tip
    env: OPTIONS="-race -cpu 2"
script:
- go fmt ./... | wc -l | grep 0
- go vet ./...
- go test $OPTIONS ./...
- if [[ -n "$COVERAGE" ]]; then bash .travis-coverage; fi
